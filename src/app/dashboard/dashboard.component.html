<div class="role py-5">
  <button class="btn btn-primary" type="button" (click)="toggleViews()" *ngIf="showEmployees"> Add New Employee</button>
  <button class="btn btn-primary" type="button" (click)="toggleViews()" *ngIf="showForm" > Show All Employees </button>
  <div class="py-5" >
    <div class="mx-4" *ngIf="showForm">
      <div class="col-12 text-center">
        <h2 class="display-4 mb-4">Add a New Employee</h2>
        <p class="lead">Here you can add information for the new employee</p>
      </div>
      <form [formGroup]="insertEmployeeForm" (ngSubmit)="submitInsertForm(insertEmployeeForm)" >
        <div class="alert alert-success" *ngIf="success">
          <p class="text-center">
            {{success}}
          </p>
        </div>
        <div class="alert alert-danger" *ngIf="errors && errors.length > 0">
          <p class="text-center">{{ errors }}</p>
        </div>
        <div class="my-3">
          <label class="form-label" for="Name">Name</label>
          <input type="text" id="Name" class="form-control" formControlName="name" />
          <div class="" *ngIf="insertEmployeeForm.get('name') && insertEmployeeForm.get('name')?.touched">
            <p class="text-danger m-0" *ngIf="insertEmployeeForm.get('name')?.getError('required')">Enter the name</p>
            <p class="text-danger m-0" *ngIf="insertEmployeeForm.get('name')?.getError('minlength')">Minimum length is 2 characters</p>
            <p class="text-danger m-0" *ngIf="insertEmployeeForm.get('name')?.getError('maxlength')">Maximum length is 50 characters</p>
          </div>
        </div>
        <div class="my-3">
          <label class="form-label" for="resume">Resume</label>
          <input type="text" id="resume" class="form-control" formControlName="resume" />
          <div class="" *ngIf="insertEmployeeForm.get('resume') && insertEmployeeForm.get('resume')?.touched">
            <p class="text-danger m-0" *ngIf="insertEmployeeForm.get('resume')?.getError('required')">Enter the resume</p>
            <p class="text-danger m-0" *ngIf="insertEmployeeForm.get('resume')?.getError('minlength')">Minimum length is 10 characters</p>
            <p class="text-danger m-0" *ngIf="insertEmployeeForm.get('resume')?.getError('maxlength')">Maximum length is 500 characters</p>
          </div>
        </div>
        <div class="my-3">
          <label class="form-label" for="salary">Salary</label>
          <input type="text" id="salary" class="form-control" formControlName="salary" />
          <div class="" *ngIf="insertEmployeeForm.get('salary') && insertEmployeeForm.get('salary')?.touched">
            <p class="text-danger m-0" *ngIf="insertEmployeeForm.get('salary')?.getError('required')">Enter the salary</p>
            <p class="text-danger m-0" *ngIf="insertEmployeeForm.get('salary')?.getError('min')">Salary must be greater than 0</p>
            <p class="text-danger m-0" *ngIf="insertEmployeeForm.get('salary')?.getError('pattern')">Salary must be a number</p>
          </div>
        </div>
        <div class="my-3">
          <label class="form-label" for="address">Address</label>
          <input type="text" id="address" class="form-control" formControlName="address" />
          <div class="" *ngIf="insertEmployeeForm.get('address') && insertEmployeeForm.get('address')?.touched">
            <p class="text-danger m-0" *ngIf="insertEmployeeForm.get('address')?.getError('required')">Enter the address</p>
            <p class="text-danger m-0" *ngIf="insertEmployeeForm.get('address')?.getError('minlength')">Minimum length is 5 characters</p>
            <p class="text-danger m-0" *ngIf="insertEmployeeForm.get('address')?.getError('maxlength')">Maximum length is 100 characters</p>
          </div>
        </div>
        <div class="my-3">
          <label class="form-label" for="phone">Phone Number</label>
          <input type="text" id="phone" class="form-control" formControlName="phone" />
          <div class="" *ngIf="insertEmployeeForm.get('phone') && insertEmployeeForm.get('phone')?.touched">
            <p class="text-danger m-0" *ngIf="insertEmployeeForm.get('phone')?.getError('required')">Enter the phone number</p>
            <p class="text-danger m-0" *ngIf="insertEmployeeForm.get('phone')?.getError('pattern')">Phone number must contain only numbers</p>
            <p class="text-danger m-0" *ngIf="insertEmployeeForm.get('phone')?.getError('minlength')">Minimum length is 11 digits</p>
            <p class="text-danger m-0" *ngIf="insertEmployeeForm.get('phone')?.getError('maxlength')">Maximum length is 11 digits</p>
          </div>
        </div>
        <div class="my-3">
          <label class="form-label" for="gender">Gender</label>
          <input type="text" id="gender" class="form-control" formControlName="gender" />
          <div class="" *ngIf="insertEmployeeForm.get('gender') && insertEmployeeForm.get('gender')?.touched">
            <p class="text-danger m-0" *ngIf="insertEmployeeForm.get('gender')?.getError('required')">Enter the gender</p>
          </div>
        </div>
        <div class="my-3">
          <label class="form-label" for="age">Age</label>
          <input type="text" id="age" class="form-control" formControlName="age" />
          <div class="" *ngIf="insertEmployeeForm.get('age') && insertEmployeeForm.get('age')?.touched">
            <p class="text-danger m-0" *ngIf="insertEmployeeForm.get('age')?.getError('required')">Enter the age</p>
            <p class="text-danger m-0" *ngIf="insertEmployeeForm.get('age')?.getError('min')">Age must be 18 or older</p>
            <p class="text-danger m-0" *ngIf="insertEmployeeForm.get('age')?.getError('max')">Age must be less than 100</p>
          </div>
        </div>
        <div class="my-3">
          <label class="form-label" for="email">Email</label>
          <input type="text" id="email" class="form-control" formControlName="email" />
          <div class="" *ngIf="insertEmployeeForm.get('email') && insertEmployeeForm.get('email')?.touched">
            <p class="text-danger m-0" *ngIf="insertEmployeeForm.get('email')?.getError('required')">Enter the email</p>
            <p class="text-danger m-0" *ngIf="insertEmployeeForm.get('email')?.getError('email')">Enter a valid email</p>
          </div>
        </div>
        <div class="my-3 text-center">
          <input type="submit" [disabled]="insertEmployeeForm.invalid" class="px-5 btn btn-primary" />
        </div>
      </form>
    </div>

    <div *ngIf="showEmployees">
      <div class="alert alert-success" *ngIf="success">
        <p class="text-center">
          {{success}}
        </p>
      </div>
      <div class="alert alert-danger" *ngIf="errors.length > 0">
          <p class="text-center">{{ errors }}</p>
      </div>
      <input type="text" class="form-control" placeholder="Search..."
      [(ngModel)]="searchQuery" (ngModelChange)="search(searchQuery)" />
      <div class="table-responsive" style="max-height: 430px; overflow-y: auto;">
        <table class="table table-dark table-hover ">
          <thead>
            <tr class="text-center">
              <th>Employee ID</th>
              <th>Name</th>
              <th>Email</th>
              <th>Salary</th>
              <th>Address</th>
              <th>Phone</th>
              <th>Gender</th>
              <th>Age</th>
              <th>Resume</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let employee of dataSource" class="text-center bg-dark ">
              <td>{{employee.id}}</td>
              <td>{{employee.name}}</td>
              <td>{{employee.email}}</td>
              <td>{{employee.salary}}</td>
              <td>{{employee.address}}</td>
              <td>{{employee.phone}}</td>
              <td>{{employee.gender}}</td>
              <td>{{employee.age}}</td>
              <td class="w-25" >{{employee.resume}}</td>
              <td class="d-flex gap-3 justify-content-center">
                <button class="btn btn-primary" data-bs-toggle="modal"
                [attr.data-bs-target]="'#update-' + employee.id"
                (click)="prepareModal(employee)">Edit</button>
                <button class="btn btn-danger"
                (click)="deleteEmployee(employee.id)" >Delete</button>

                <div class="modal" [attr.id]="'update-' + employee.id">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h4 class="modal-title text-dark">Edit Employee</h4>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                      </div>
                      <div class="modal-body text-dark">
                        <form [formGroup]="updateEmployeeForm" (ngSubmit)="updateEmployee()">
                          <div class="row">
                            <div class=" col-md-6 my-3">
                              <input type="hidden" class="form-control" formControlName="id" />
                              <label class="form-label" for="Name">Name</label>
                              <input type="text" id="Name" class="form-control" formControlName="name" />
                              <div class="" *ngIf="updateEmployeeForm.get('name') && updateEmployeeForm.get('name')?.touched">
                                <p class="text-danger m-0" *ngIf="updateEmployeeForm.get('name')?.getError('required')">Enter the name</p>
                                <p class="text-danger m-0" *ngIf="updateEmployeeForm.get('name')?.getError('minlength')">Minimum length is 2 characters</p>
                                <p class="text-danger m-0" *ngIf="updateEmployeeForm.get('name')?.getError('maxlength')">Maximum length is 50 characters</p>
                              </div>
                            </div>
                            <div class=" col-md-6 my-3">
                              <label class="form-label" for="resume">Resume</label>
                              <input type="text" id="resume" class="form-control" formControlName="resume" />
                              <div class="" *ngIf=" updateEmployeeForm.get('resume') &&  updateEmployeeForm.get('resume')?.touched">
                                <p class="text-danger m-0" *ngIf=" updateEmployeeForm.get('resume')?.getError('required')">Enter the resume</p>
                                <p class="text-danger m-0" *ngIf=" updateEmployeeForm.get('resume')?.getError('minlength')">Minimum length is 10 characters</p>
                                <p class="text-danger m-0" *ngIf=" updateEmployeeForm.get('resume')?.getError('maxlength')">Maximum length is 500 characters</p>
                              </div>
                            </div>
                            <div class=" col-md-6 my-3">
                              <label class="form-label" for="salary">Salary</label>
                              <input type="text" id="salary" class="form-control" formControlName="salary" />
                              <div class="" *ngIf=" updateEmployeeForm.get('salary') &&  updateEmployeeForm.get('salary')?.touched">
                                <p class="text-danger m-0" *ngIf=" updateEmployeeForm.get('salary')?.getError('required')">Enter the salary </p>
                                <p class="text-danger m-0" *ngIf=" updateEmployeeForm.get('salary')?.getError('min')">Salary must be greater than 0</p>
                                <p class="text-danger m-0" *ngIf=" updateEmployeeForm.get('salary')?.getError('pattern')">Salary must be a number</p>
                              </div>
                            </div>
                            <div class=" col-md-6 my-3">
                              <label class="form-label" for="address">Address</label>
                              <input type="text" id="address" class="form-control" formControlName="address" />
                              <div class="" *ngIf=" updateEmployeeForm.get('address') &&  updateEmployeeForm.get('address')?.touched">
                                <p class="text-danger m-0" *ngIf=" updateEmployeeForm.get('address')?.getError('required')">Enter the address</p>
                                <p class="text-danger m-0" *ngIf=" updateEmployeeForm.get('address')?.getError('minlength')">Minimum length is 5 characters</p>
                                <p class="text-danger m-0" *ngIf=" updateEmployeeForm.get('address')?.getError('maxlength')">Maximum length is 100 characters</p>
                              </div>
                            </div>
                            <div class=" col-md-6 my-3">
                              <label class="form-label" for="phone">Phone Number</label>
                              <input type="text" id="phone" class="form-control" formControlName="phone" />
                              <div class="" *ngIf=" updateEmployeeForm.get('phone') &&  updateEmployeeForm.get('phone')?.touched">
                                <p class="text-danger m-0" *ngIf=" updateEmployeeForm.get('phone')?.getError('required')">Enter the phone number</p>
                                <p class="text-danger m-0" *ngIf=" updateEmployeeForm.get('phone')?.getError('pattern')">Phone number must contain numbers only</p>
                                <p class="text-danger m-0" *ngIf=" updateEmployeeForm.get('phone')?.getError('minlength')">Minimum length is 11 numbers</p>
                                <p class="text-danger m-0" *ngIf=" updateEmployeeForm.get('phone')?.getError('maxlength')">Maximum length is 11 numbers</p>
                              </div>
                            </div>
                            <div class=" col-md-6 my-3">
                              <label class="form-label" for="gender">Gender</label>
                              <input type="text" id="gender" class="form-control" formControlName="gender" />
                              <div class="" *ngIf=" updateEmployeeForm.get('gender') &&  updateEmployeeForm.get('gender')?.touched">
                                <p class="text-danger m-0" *ngIf=" updateEmployeeForm.get('gender')?.getError('required')">Enter the gender</p>
                              </div>
                            </div>
                            <div class=" col-md-6 my-3">
                              <label class="form-label" for="age">Age</label>
                              <input type="text" id="age" class="form-control" formControlName="age" />
                              <div class="" *ngIf=" updateEmployeeForm.get('age') &&  updateEmployeeForm.get('age')?.touched">
                                <p class="text-danger m-0" *ngIf=" updateEmployeeForm.get('age')?.getError('required')">Enter the age</p>
                                <p class="text-danger m-0" *ngIf=" updateEmployeeForm.get('age')?.getError('min')">Age must be 18 or older</p>
                                <p class="text-danger m-0" *ngIf=" updateEmployeeForm.get('age')?.getError('max')">Age must be less than 100</p>
                              </div>
                            </div>
                            <div class=" col-md-6 my-3">
                              <label class="form-label" for="email">Email</label>
                              <input type="text" id="email" class="form-control" formControlName="email" />
                              <div class="" *ngIf=" updateEmployeeForm.get('email') &&  updateEmployeeForm.get('email')?.touched">
                                <p class="text-danger m-0" *ngIf=" updateEmployeeForm.get('email')?.getError('required')">Enter the email</p>
                                <p class="text-danger m-0" *ngIf=" updateEmployeeForm.get('email')?.getError('email')">Enter a valid email</p>
                              </div>
                            </div>
                          </div>
                          <div class="d-flex justify-content-between">
                            <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
                            <button type="submit" class="btn btn-primary" data-bs-dismiss="modal" >Save Changes</button>
                          </div>
                        </form>
                      </div>
                    </div>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
